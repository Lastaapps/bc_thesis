
\chapter{Stable cuts}%
\label{chapter:stable_cuts}

\begin{chapterabstract}
	%
	We introduce relation between stable cuts and NAC-colorings.
	We summarize progress done on stable cuts existence and search.
	Lastly we briefly describe an algorithm that can find a stable cut
	for any flexible graph.
	%
\end{chapterabstract}

\section{Stable cuts}

In this chapter we focus on connected graphs only as graph cuts lose their
meaning on disconnected graphs.
%
\begin{definition}[Stable cut]
	Independent set of a graph \( G \) is set \( I \subseteq V(G) \)
	such that \( \forall u, v \in I : \{u, v\} \not\in E(G) \).
	%
	Vertex cut of a graph \( G \) is set \( C \subseteq V(G) \)
	such that \( G \setminus C \) (\( G \) with \( C \) removed)
	is a disconnected graph.
	%
	Stable cut of a graph \( G \) is a set \( S \subseteq V(G) \) such that
	\( S \) is independent set in \( G \) and also \( S \) is vertex cut in \( G \).
\end{definition}
%

Notice how stable cuts are related to NAC-colorings.
%
\begin{lemma}[\cite{legersky_original}]
	Let \( S \) be a stable cut in \( G \).
	Then \( G \) has a NAC-coloring \( \delta \).
\end{lemma}
%
\begin{proof}
	As \( S \) is a cut in \( G \), let us have corresponding partitions \( A, B \).
	We know that \( |S| < |A|, |S| < |B| \)
	as disconnected partitions are nonempty and \( G \) was connected.
	There is at least one edge incident to vertices in both \( A \) and \( B \).
	We color \( E(G[A]) \) \( \red \) and \( E(G[B]) \) \( \blue \).
	Both colors were used, so the coloring is surjective.
	We also need to show that no almost cycle was created.
	As~\cite[Lemma 2.4]{legersky_original} states, there is no almost cycle
	in a graph if and only if components \( G_\red^\delta, G_\blue^\delta \)
	are induced subgraphs of \( G \).
	That is the case as there is no edge incident to vertices in \( S \).
	It holds that \( G_\red^\delta = G[A], G_\blue^\delta = G[B] \).
	So there are no almost cycles and \( \delta \) is a NAC-coloring.
\end{proof}
%

The statement can be extended to the following simple observation.
%
\begin{corollary}[\cite{legersky_original}]
	Let \( G \) be a connected graph with \( |E(G)| \ge 2 \).
	If there is a vertex \( v \in V(G) \) such that it is
	not contained in any triangle \( C_3 \) in \( G \),
	then the graph \( G \) has a NAC-coloring.
\end{corollary}
%
\begin{proof}
	If \( v \) is in no triangle, then there is no edge interconnecting
	vertices in \( N(v) \). Therefore, \( N(v) \) is a stable cut and \( G \)
	has a NAC-coloring.
\end{proof}

You can also prove the above lemma from the fact that every cycle that
uses a vertex in \( S \) must pass
through at least one vertex in \( A \setminus S \) and \( B \setminus S \).
Such cycle has at least four edges,
at least two are \( \red \) and at least two are \( \blue \).

It is known for some classes that stable cut must exists.
\todo[inline]{Show and cite that \( 2V-4 \) are flexible}
%
\begin{theorem}[\cite{stable_cuts_2v_4}]
	Let \( G \) be a graph with \( |E(G)| \le 2|V(G)|-4 \).
	Then \( G \) contains a stable cut.
\end{theorem}
%
This result can be extended to graphs \( |E(G)| \le 2|V(G)|-3 \) with exception
for graphs from graph class \( \GSC \).
%
\begin{itemize}
	\item Triangle and prism are in \( \GSC \).
	\item If \( H, K \in \GSC \), and \( G \) is a graph
	      formed from \( H, K \) by an edge identification,
	      then also \( G \in \GSC \).
	\item If \( H, K \in \GSC \), and \( G \) is a graph
	      formed from \( H, K \) by a triangle identification,
	      then also \( G \in \GSC \).
\end{itemize}
%
%
\begin{theorem}[\cite{stable_cuts_2v_3,stable_cuts_2v_3_revisit}]
	Let \( G \) be a graph with \( |E(G)| \le 2|V(G)|-3 \). Then \( G \) contains
	a stable cut or \( G \in \GSC \).
\end{theorem}
%
Note that 2-trees (\Cref{def:2-tree})
are in \( \GSC \) by definition.
%
\begin{lemma}[\cite{stable_cuts_legersky}]
	For every \( G \in \GSC \), either \( G \) has a NAC-coloring
	or \( G \) is a 2-tree.
\end{lemma}
%
This shows that the property of having a NAC-coloring and having a stable cut
are not equivalent.

\section{Algorithms}

As proved in~\cite{stable_cuts_complexity} it is NP-complete
to decide whether a line graph with maximum degree five admits a stable cut
-- similar result as we show for NAC-coloring in a following chapter.

The papers~\cite{stable_cuts_2v_3,stable_cuts_2v_3_revisit} do not provide
an algorithm to find the stable cut (if present)
for graphs where \(|E(G)| \le 2|V(G)|-3 \),
they only provide list of claims
from whose a stable cut set can be found.
All the checks can be run in polynomial time.
Unfortunately, the list is long and beyond the scope of this thesis.

As shown in~\cite[Algorithm 1]{stable_cuts_legersky} a stable cut can be found
in a polynomial time for any flexible graph.
As mentioned before, that also includes graphs
where \( |E(G)| \le 2|V(G)| - 4 \) (not for \( |E(G)| \le 2|V(G)| - 3 \)).
Rigid component of a graph is maximal induced subgraph such that
The main idea of the algorithm works as follows:
%
\begin{itemize}
	\item Rigid components of the graphs are found.
	\item Vertices \( u, v \) from different rigid components are chosen.
	\item If neighborhood of \( u \) is a stable cut, return it.
	\item Otherwise, contract one edge of a triangle with \( u \) and start again while preserving \( u \).
\end{itemize}

Here we show pseudocode of the algorithm as described
in the original paper~\cite{stable_cuts_legersky}.
%
\begin{algorithm}[ht]
	\caption{\textsc{Stable cut of a connected flexible graph}}%
	\label{alg:stableCutFlexible}%
	\begin{algorithmic}[1]
		\Require{} a connected flexible graph $G$, vertices $u$ and $v$ not in the same rigid component of $G$
		\Ensure{} a stable cut $S$ of $G$ such that $u$ and $v$ are separated by $S$
		\If{the neighborhood of $u$ is stable}
		\State\Return{} the neighborhood of $u$
		\Else{}
		\State{} $x_1,x_2 :={}$ neighbors of $u$ such that $(u,x_1,x_2)$  is a $3$-cycle
		\For{$i\in\{1,2\}$}
		\State{} $G'_i :={}$ the graph obtained from $G$ by contracting the edge $ux_i$
		\State{} $u'_i :={}$ the vertex of $G'_i$ corresponding to the contracted edge $ux_i$
		\EndFor{}
		\If{$u'_1$ and $v$ are in different rigid components of $G'_1$}
		\State\Return{} a stable cut of $G'_1$ separating $u'_1$ and $v$
		\Else{}
		\State\Return{} a stable cut of $G'_2$ separating $u'_2$ and $v$
		\EndIf{}
		\EndIf{}
	\end{algorithmic}
\end{algorithm}
%

\Cref{alg:stableCutFlexible}
was presented as a practical result of the following theorem.
%
\begin{theorem}[\cite{stable_cuts_legersky}]
	Let \( G \) be a flexible graph and \( u, v \in V (G) \) be such that no rigid component of \( G \)
	contains both \( u \) and \( v \). Then there is a stable cut \( S \) of \( G \) that separates \( u \) and \( v \), and such that
	every rigid component of \( G \) contains at most one vertex of \( S \). Moreover, if \( G \) is 2-connected,
	then for every vertex \( v \in V(G) \), \( G \) has a stable cut avoiding \( v \).
\end{theorem}
%
Notice that \Cref{alg:stableCutFlexible}
chooses vertices \( u, v \) arbitrary as long as they do not share a rigid component.
A check ensuring that \( u \) and \( v \) are in different rigid components
has to be added on top of this seemingly random choice.
The same check holds when \( u \) is specified.

We may also want to let user choose a vertex \( u \) and find a stable cut
that avoids it or
let user choose the vertices \( u, v \) and find a stable cut
that separates them.
In this case additional checks are needed. First if only \( u \) is specified,
it may happen that it may not be avoidable if the vertex is contained
an intersection of multiple rigid components from which the graph is formed.
In such case \( u \) is an articulation vertex and the only stable cut in the graph
and the user is notified.
When both \( u, v \) are specified,
it is possible that \( u \) and \( v \) are in the same rigid components.
In that case the user is also notified.

%
\Cref{alg:stableCutFlexible}
is implemented and contributed as part of this thesis
to PyRigi~\cite{pyrigi} in pull request~\cite{pyrigi_pr_stable_cuts}.

