
\chapter{Preliminaries}%
\label{chapter:preliminaries}

\begin{chapterabstract}

	In~this chapter, we~define terminology from Rigidity theory including NAC-colorings.
	We~also introduce its relation to Rigidity theory and
	some simple statements considering
	the~structure of graphs and NAC-coloring existence.

\end{chapterabstract}

\section{Rigidity theory}

Rigidity theory, often also called Structural rigidity,
is an~area combining among the~others
combinatorics and discrete and computational geometry,
which studies properties of objects formed from joints and rigid bars.
These objects can be represented as graphs with
a~mapping into \( d \)-dimensional space.
Rigidity theory studies if~such objects are rigid or flexible.

For~the~rest of the~thesis,
we~consider only simple undirected graphs.
Often, only connected graphs are considered as disconnected graphs
represent uninteresting trivial cases.
By \( V(G) \) we~denote the~vertices of a~graph \( G \) and
by \( E(G) \) we~denote the~edges of~\( G \).

By \( G - v \), resp.\ \( G - e \),
where \( v \in V(G), e \in E(G) \) we~denote the~graph
formed from \( G \) by removing vertex \( v \), resp.\ edge \( e \).
Formally,
\( G - v = (V(G) \setminus \{v\}, E(G) \setminus \{\{u, v\} \mid u \in V(G)\}) \)
and \( G - e = (V(G), E(G) \setminus \{e\}) \).
%
By \( G \setminus S \), resp.\ \( G \setminus F \),
where \( S \subseteq V(G), F \subseteq E(G) \) we~denote the~graph
formed from \( G \) by removing vertices \( S \), resp.\ edges \( F \).
Formally,
\( G \setminus S = (V(G) \setminus S, E(G) \setminus \{\{u, v\} \mid v \in S, u \in V(G)\}) \)
and \( G \setminus F = (V(G), E(G) \setminus F) \).

The~following definitions are taken from~\cite{np_complete,my_paper}.

%
\begin{definition}[\( d \)-realization]
	A~\emph{\( d \)-realization} of a~graph \( G \) is a~mapping \( p: V(G) \to \R^d \).
\end{definition}
%
\begin{definition}[Framework]
	A~\emph{framework} is a~pair of a~graph \( G \) and its realization.
\end{definition}
%
\begin{definition}[Nontrivial flex]
	A~\emph{nontrivial flex} of framework \( (G, p) \) is a~continuous curve of realizations \( p_t \)
	for \( 0 \le t \le 1\) such that
	\( p_0 = p \) and for~all \( 0 < t \le 1 \)
	we have that
	\( \|p_t(u) - p_t(v)\| = \|p(u) - p(v)\|\) for~every \( \{u, v\} \in E(G) \),
	but \( \|p_t(u) - p_t(v)\| \ne \|p(u) - p(v)\| \) for~some \( u, v \in V (G) \).
\end{definition}
%
\begin{definition}[\( d \)-flexible, \( d \)-rigid]
	A~framework is \emph{\( d \)-flexible}, if~it has a~nontrivial flex.
	Otherwise, it~is \emph{\( d \)-rigid}.
\end{definition}
%
Realizations that differ only by translation,
rotation or reflection are called \emph{congruent}.
%
For~a~\( d \)-rigid realization, there may still be noncongruent realizations
with the~same distances between vertices connected by edges.
%
If~there are no such realizations for~a~\( d \)-rigid realization,
we~call such realization \emph{globally \( d \)-rigid}.
To summarize all the~previous definitions,
a~framework is \( d \)-flexible if~it can be continuously deformed
while preserving the~lengths of the~edges of the~graph.

From now on, we~consider only \emph{quasi-injective} realizations ---
two neighboring vertices cannot be mapped to the~same position.
This is equivalent to the~distances between adjacent vertices being positive.
Note that two non-neighboring vertices can be mapped to the~same position.
The~existence of \emph{injective} flexible realizations
has been also studied~\cite{injective_realizations},
but they are of no interest for~us in~this thesis
as there is no known combinatorial characterization
of graphs with an injective flexible realization in \( \R^2 \).

For~\( d = 1 \) or \( d \ge 3 \),
the~question whether a~graph has a~flexible \( d \)-framework is simple.
%
For~\( d = 1 \), all the~vertices are on a~line
and any vertex deviation necessarily changes distances (if the~graph is connected).
Therefore, there is no flexible realization if~and only if~the~graph is connected.
%
For~\( d \ge 3 \), we~can map all the~vertices except two nonadjacent ones
onto a~line and rotate one of them around the~line.
Therefore, flexible \( d \)-framework exists if~and only if~the~graph is not complete.

It~is NP-hard to decide whether a~given \( d \)-dimensional framework is
\( d \)-rigid for~\( d \ge 2 \)~\cite{d_rigidity_hardness}.
We~can simplify the~problem if~we talk about \emph{generic} behavior.
%
For~rigid graphs, it~holds that almost all%
\nohznamka{
	If~a~condition holds for~almost all elements of an~infinite set,
	then the~condition holds for~all elements except for~a~subset of measure zero.
}
realizations are \( d \)-rigid or almost all realizations are \( d \)-flexible.
As there may be few \( d \)-flexible realizations,
we~talk about paradoxical flexibility.
%
\begin{definition}[Flexible \& rigid graphs~\cite{generically_rigid_graphs}]
	A~graph is \emph{(generically) \( d \)-flexible} if~almost all of
	its \( d \)-realizations are \( d \)-flexible.
	A~graph is \emph{(generically) \( d \)-rigid} if~almost all of
	its \( d \)-realizations are \( d \)-rigid.
\end{definition}
%


There is a~significant graph class studied in~Rigidity theory
called minimally rigid graphs or Laman graphs.
%
\begin{definition}
	A~graph \( G \) is \emph{minimally generically \( d \)-rigid} if~it is \( d \)-rigid
	and \( G - e \) is \(d\)-flexible for~each \( e \in E(G) \).
\end{definition}
%
From now on, we~focus only on the~\( 2 \)-dimensional case,
in~which there is a~combinatorial characterization of rigid graphs.
When we~use \emph{rigid} or \emph{flexible} we~mean \( 2 \)-rigid or \( 2 \)-flexible.

Pollaczek-Geiringer and later Laman gave characterization of minimally $2$-rigid graphs.
%
\begin{theorem}[\cite{polzacek_1927,laman_1970}]%
	\label[theorem]{theorem:laman_characterization}
	%
	A~graph \( G \) is minimally \( 2 \)-rigid if~and only if
	\( |E(G)| = 2|V(G)| - 3\) and
	\( |E(H)| \le 2|V(H)| - 3 \) for~any \( H \) subgraph of \( G \)
	with at least two vertices.
\end{theorem}
%
\begin{corollary}[\cite{polzacek_1927,laman_1970}]
	For~a~graph \( G \) where \( |E(G)| < 2|V(G)| - 3 \) or
	where \( |E(G)| = 2|V(G)| - 3 \) and there exists a~subgraph \( H \) such that \( |E(H)| > 2|V(H)| - 3 \),
	there exists a~flexible realization of \( G \).
\end{corollary}
%
Based on \Cref{theorem:laman_characterization},
a~polynomial algorithm
for~testing $2$-rigidity was obtained~\cite{polynomial-min-rigid}.
A~combinatorial classification of $d$-rigid graphs
for~$d \geq 3$ remains an~open problem.

It~is already known for~some classes of graphs that they are flexible.
Namely, graphs where \( |E(G)| \le 2|V(G)| - 4 \) are flexible.
This can be seen form \Cref{theorem:laman_characterization}.
Every rigid graph contains a~spanning minimally rigid subgraph
(obtained by repeatably removing edges),
such that it~has exactly \( 2|V(G)| - 3 \) edges.
So a~graph with less than \( 2|V(G)| - 3 \) edges cannot be rigid.

% It~can be derived from the~fact that for~\( |V(G)| \) vertices,
% there are \( 2|V(G)| \) degrees of freedom in~the~\( 2 \)-dimensional space.
% We~can fix translation, rotation and reflection of the~graph
% by fixing three vertices and by using \( 3 \) edges.
% %
% By adding a~single, we~fix one degree of freedom.
% Therefore, we~can fix the~remaining \( |V(G)| - 3 \) vertices
% (\( 2|V(G)| - 6 \) degrees of freedom)
% by using at least \( 2|V(G)| - 6 \) edges.
% But when there are less than \( 2|V(G)| - 3 \) edges in~total,
% we~cannot ever fix enough degrees of freedom.


There are polynomial algorithms for~testing \( 2 \)-rigidity
for~minimally rigid graphs, see for~example~\cite{polynomial-min-rigid}.
We~focus more on these graphs in~benchmarks.


\section{NAC-colorings}

It~is algorithmically hard to find flexible realizations of a~graph
just by trying realizations and checking if~they are flexible.
In~\cite{legersky_original} a~new edge coloring is proposed
that corresponds with the~existence of a~flexible realization.

\begin{definition}[NAC-coloring~\cite{legersky_original}]
	Let~\( G \) be a~graph and \( \delta: E(G) \to \{ \red, \blue \} \)
	be a~coloring of its edges:
	%
	\begin{itemize}
		\item A~cycle in~\( G \) is a~\( \red \) cycle, if~all its edges are \( \red \),
		      analogously for~\( \blue \) cycles.
		\item A~cycle in~\( G \) is an~\emph{almost \( \red \) cycle},
		      if~exactly one of its edges is \( \blue \).
		      \emph{Almost \( \blue \) cycle} is defined analogously.
	\end{itemize}
	%
	By \emph{an almost cycle} we~denote both almost \( \red \) and almost \( \blue \) cycles.
	The~coloring~\( \delta \) is called a~\emph{NAC-coloring}, if~it is surjective
	and there are no almost cycles.
\end{definition}
%

\begin{figure}[ht]
	% original scale * 4/5
	\centering
	\begin{tikzpicture}[scale=1.2] % 1.5
		\node[fvertex] (a) at (0,0) {};
		\node[fvertex] (b) at (1,0) {};
		\node[fvertex] (c) at (0.5,0.5) {};
		\node[fvertex] (d) at (0,1) {};
		\node[fvertex] (e) at (1,1) {};
		\node[fvertex] (f) at (0.5,1.5) {};
		\draw[edge] (a)edge(b) (b)edge(c) (c)edge(a) (d)edge(e) (e)edge(f) (f)edge(d) (a)edge(d) (b)edge(e) (c)edge(f);
	\end{tikzpicture}
	\quad
	\begin{tikzpicture}[scale=1.2] % 1.5
		\node[vertex] (a) at (0,0) {};
		\node[vertex] (b) at (1,0) {};
		\node[vertex] (c) at (0.5,0.5) {};
		\node[vertex] (d) at (0,1.5) {};
		\node[vertex] (e) at (1,1.5) {};
		\node[vertex] (f) at (0.5,1) {};
		\draw[bedge] (a)edge(b) (b)edge(c) (c)edge(a) (d)edge(e) (e)edge(f) (f)edge(d) ;
		\draw[redge] (a)edge(d) (b)edge(e) (c)edge(f);
	\end{tikzpicture}
	\qquad
	\begin{tikzpicture}[scale=0.55] % 0.75
		\draw[black!50!white, dashed] (-1.5,0)edge(2.3,0);
		\draw[black!50!white, dashed] (0,1.55)edge(0,-2.1);
		\node[fvertex] (2) at (1.8, 0) {};
		\node[fvertex] (5) at (-1., 0) {};
		\node[fvertex] (7) at (0.7, 0) {};
		\node[fvertex] (1) at (0, -1.75) {};
		\node[fvertex] (6) at (0,  1.2) {};
		\node[fvertex] (4) at (0, -0.8) {};
		\draw[edge]  (6)edge(5) (5)edge(4) (7)edge(4) (7)edge(6);
		\draw[edge] (2)edge(4) (2)edge(6);
		\draw[edge] (1)edge(5) (7)edge(1) ;
		\draw[edge] (2)edge(1);
	\end{tikzpicture}
	\quad
	\begin{tikzpicture}[scale=0.96] % 1.2
		\node[vertex] (a1) at (-0.5, -0.866025) {};
		\node[vertex] (a2) at (0.5, -0.866025) {};
		\node[vertex] (a3) at (1., 0.) {};
		\node[vertex] (a4) at (0.5, 0.866025) {};
		\node[vertex] (a5) at (-0.5, 0.866025) {};
		\node[vertex] (a6) at (-1.,  0.) {};
		\draw[bedge] (a1)edge(a2) (a1)edge(a4) (a1)edge(a6);
		\draw[redge] (a2)edge(a3) (a2)edge(a5) (a3)edge(a4) (a3)edge(a6) (a5)edge(a4) (a5)edge(a6);
	\end{tikzpicture}
	\quad
	\begin{tikzpicture}[scale=0.96] % 1.2
		\node[vertex] (a1) at (-0.5, -0.866025) {};
		\node[vertex] (a2) at (0.5, -0.866025) {};
		\node[vertex] (a3) at (1., 0.) {};
		\node[vertex] (a4) at (0.5, 0.866025) {};
		\node[vertex] (a5) at (-0.5, 0.866025) {};
		\node[vertex] (a6) at (-1.,  0.) {};
		\draw[bedge] (a1)edge(a2) (a1)edge(a4) (a2)edge(a3) (a3)edge(a4) (a5)edge(a6);
		\draw[redge] (a1)edge(a6) (a2)edge(a5) (a3)edge(a6) (a5)edge(a4) ;
	\end{tikzpicture}
	\caption[NAC-colorings of $3$-prism and $K_{3,3}$]{
		The~$3$-prism and $K_{3,3}$ are rigid, but both have flexible
		realizations.
		The~$3$-prism has a~unique NAC-coloring modulo swapping colors,
		while all NAC-colorings of $K_{3,3}$ are isomorphic to the~two displayed ones.
		The~figures are taken from~\cite{stable_cuts_legersky}.
	}%
	\label{fig:3prismK33flexible}
\end{figure}

An~example of a NAC-coloring and the corresponding flexible realization
can be seen in~\Cref{fig:3prismK33flexible}.
%
As shown in~\cite{np_complete}, it~is NP-complete to decide if~a~graph has a~NAC-coloring.
We~elaborate further on this in~later chapters.
Let~\( E_\red\), resp.\ \( E_\blue \), be edges colored by \( \red \), resp.~\( \blue \),
in~an~edge coloring \( \delta \).
%
\begin{lemma}[\cite{legersky_original}]%
	\label[lemma]{lemma:is_nac_coloring}
	Let~\( G \) be a~graph. If~\( \delta: E(G) \to \{ \red, \blue \} \) is a~coloring of edges,
	then there are no almost cycles in~\( G \) if~and only if~the~connected components
	of \( G[E_\red] \) and \( G[E_\blue] \)%
	\footnote{
		For~\(Y \subseteq E(G)\), by \(G[Y]\) we~denote
		the~induced subgraph of \( G \) on edges \( Y \),
		\( G[Y] = (\{ v \mid \exists u \in V(G) : \{u, v\} \in Y\}, Y) \).
		%
		We~also later use a~similar notation for~vertex-induced components:
		for \(X \subseteq V(G)\), by \(G[X]\) we~denote
		the~induced subgraph of \( G \) on vertices \( X \),
		\( G[X] = (X, \{ \{u, v\} \in E(G) \mid u, v \in X\}) \).
	}
	are induced subgraphs of \( G \).
\end{lemma}
%
The~idea is quite simple --- if~there is w.l.o.g.\ \( \blue \) edge \( \{u, v\} \)
and \( \{u, v\} \) share the~same connected component in~\( G[E_\red] \),
an~almost cycle is formed from a~\( u \)-\( v \)-path in~\( G[E_\red] \)
and the~edge \( \{u, v\} \).
The~check can be done in~polynomial (linear) time.

Now we~present a~relation of NAC-colorings and flexible frameworks.
%
\begin{theorem}[\cite{legersky_original}]
	A~connected graph \( G \) with at least one edge has a~flexible
	quasi-injective \( 2 \)-dimensional realization if~and only if~it has a~NAC-coloring.
\end{theorem}
%
The~theorem has a~constructive proof from which a~flexible realization
can be found for~a~given NAC-coloring.
The~proof itself is nontrivial, and we~do not show it~here.
For~us, the~most interesting questions are whether a~graph has a~NAC-coloring
and how many NAC-coloring does a~graph have.
For~example, have a~look at \Cref{fig:3prism}
from Introduction.

Note that for~each NAC-coloring \( \delta \) on a~graph \( G \),
there exists a~NAC-coloring~\( \delta^\prime \) on~\( G \)
where \( \red \) and \( \blue \) colors are swapped.
%
\begin{definition}
	By \( \nac{G} \) we~denote the~set of all the~NAC-colorings of graph \( G \).
	By \( \nnac{G} \) we~denote the~number of NAC-colorings of \( G \)
	up to swapping the~colors.
	That is \( \nnac{G} = | \nac{G} | / 2 \)
\end{definition}
%

In~algorithms related to NAC-coloring search, it~is beneficial
to reduce the~search space.
It~can often be seen from the~graph's structure
that if~colors differ for~some set of edges,
the~resulting coloring cannot be a~NAC-coloring.
%
For~instance, all the~edges of a~3-cycle subgraph \( C_3 \) must map to the~same color.
Otherwise, two edges of \( C_3 \) are w.l.o.g.\ \( \red \) and one is \( \blue \).
Therefore, \( C_3 \) forms an~almost cycle.
This idea can be expanded further to neighboring triangles.
%
\begin{definition}[\( \triangle \)-connected component~\cite{legersky_original}]
	\label[definition]{def:triangle_connected_component}
	Let~\( G \) be a~graph and \( \sim^\prime_\triangle \) be
	a~relation on \( E(G) \) such that \( e_1 \sim^\prime_\triangle e_2 \)
	if and only if~there exists a 3-cycle subgraph \( C_3 \) of \( G \)
	such that \( e_1, e_2 \in E(C_3) \).
	Let~\( \sim_\triangle \) be the~reflexive-transitive closure of \( \sim^\prime_\triangle \).
	The~graph \( G \) is called \emph{\trcon{}} if~\( e_1 \sim_\triangle \)
	for all \( e_1, e_2 \in E(G) \).
	A~\emph{\trcon{} component} is a~maximal subgraph \( G^\prime \) of \( G \) such
	that \( G^\prime \) is \( \triangle \)-connected.
\end{definition}
%
\begin{lemma}[\cite{legersky_original}]
	Let~\( \delta \) be a~\rbcol{} of a~graph \( G \) such that there are
	no almost cycles. If~\( G^\prime \) is
	a~\( \triangle \)-connected subgraph of \( G \),
	then \( \delta(e_1) = \delta(e_2) \) for~all \( e_1, e_2 \in E(G^\prime) \).
\end{lemma}
%
The~naive algorithm that is described in~more detail in~the~following chapters
iterates through all the~possible edge colorings of a~graph.
If~\( \triangle \)-connected components are employed in~the~algorithm,
the~whole \( \triangle \)-connected components can be checked instead of individual edges.
We~further improve the~idea of \( \triangle \)-connected components later.

Now we~define common terminology with the~goal to define stable cuts in~a~graph.

%
\begin{definition}[Stable set]
	A~\emph{stable set} of a~graph \( G \) is a~set \( S \subseteq V(G) \) such that
	\( \forall u, v \in S : \{u, v\} \not\in E(G) \).
\end{definition}
%
Stable set is also often called an~\emph{independent set}.
%
\begin{definition}[Vertex cut]
	A~\emph{vertex cut} of a~graph \( G \) is a~set \( S \subseteq V(G) \) such that
	\( G \setminus S \) is a~disconnected graph.
	%
	Vertices \( u, v \in V(G) \) are separated by \( S \)
	if \( u, v \not\in S \)
	and there is no path from \( u \) to \( v \) in~\( G \setminus S \).
\end{definition}
%
\begin{definition}[Edge cut]
	An~\emph{edge cut} of a~graph \( G \) is a~set \( F \subseteq E(G) \) such that
	\( G \setminus F \) is a~disconnected graph.
\end{definition}
%
\begin{definition}[Stable cut]%
	\label[definition]{def:stable_cut}
	A~\emph{stable cut} is a~stable set of vertices that is also a~vertex cut.
\end{definition}
%
If~there is a~stable cut in~a~graph, a~NAC-coloring can be simply found.
We~elaborate more on this case in~\Cref{chapter:stable_cuts}.

We~continue with other lemmas that are useful in~our algorithm.
They allow us to find a~NAC-coloring of a~graph in~polynomial time for~some graph classes.
%
\begin{lemma}[\cite{legersky_original}]%
	\label[lemma]{lemma:weird_four_cycle}
	%
	Let~\( G \) be a~connected graph such that \( |E(G)| \ge 2 \). If~there is an~edge cut \( E_c \subseteq E(G) \)
	in~\( G \) and the~subgraph of \( G \)
	induced by \( E_c \) contains no path of length four, then \( G \) has a~NAC-coloring.
\end{lemma}
%
The~original proof constructs a~NAC-coloring by first considering
\( E_c^\prime \) minimal subset of \( E_c \)
such that it~is also an~edge cut in~\( G \).
We~color edges in~\( E_c^\prime \) \( \red \) and the~other edges \( \blue \).
See~\cite{legersky_original} for~a~complete proof.

For~a~graph \( G \), some vertex \( v \in G \) is \emph{an articulation} vertex if
\( \{v\} \) is a~vertex cut in~\( G \).
When all the~articulation vertices are found,
the~graph can be decomposed into blocks
--- vertex \( 2 \)-connected components.
As no cycles pass through multiple blocks, we~can color each block
independently as long as both colors are used~\cite{my_paper}.
We~formalize this observation later.

There are other useful graph properties related to stable cuts
that will be introduced later in~\Cref{chapter:stable_cuts}.

